<link rel="import" href="/bower/polymer/polymer.html">

<link rel="import" href="/bower/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="/assets/elements/polymer-flip.html">
<link rel="import" href="/assets/elements/draw-card.html">
<link rel="import" href="/assets/elements/place-card.html">

<dom-module id="card-element">
  <style>
    :host {
      top: 0;
      left: 0;
      position: absolute;
      width: 100%;
      height: 100%;
      transform: translate3d(0,0,0) rotateY(0deg);
      transform-origin: 50% 0%;
      transition: all 300ms;
      -webkit-transform-style: preserve-3d;
    }
    img {
      width: 100%;
      backface-visibility: hidden;
    }
    img.splash {
      position: absolute;
      width: calc(100% - 10px);
      top: 5px;
      left: 5px;
    }
    .face {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      box-sizing: border-box;
    }
    .front.face {
      z-index: 10;
    }
    .back.face {
      transform: rotateY(-180deg);
    }
  </style>
  <template>
    <div class="front face">
      <img src="/assets/images/card-front.png">
      <img class="splash" src="{{ front }}">
    </div>
    <div class="back face">
      <img src="/assets/images/card-back.png">
    </div>
  </template>

<script>
  Polymer({
    is: "card-element",
    behaviors: [
      Polymer.NeonAnimationRunnerBehavior
    ],
    properties: {
      name: {
        type: String,
        value: null,
      },
      faceup: {
        type: Boolean,
        value: true,
        observer: "faceup_changed",
        notify: true
      },
      front: {
        type: String,
        value: "/assets/images/card-front-background.png"
      },
      back: {
        type: String,
        value: "/assets/images/card-back.png"
      }
    },
    face: function(face) {
      return this.faceup ? face === 'up' : face === 'down';
    },
    flip: function() {
      this.faceup = !this.faceup;
    },
    faceup_changed: function() {
      if (this.faceup) {
        this.style.transform = "rotateY(0deg)";
      } else {
        this.style.transform = "rotateY(180deg)";
      }
    },
    ready: function() {
      if (! this.faceup) {
        this.faceup = false;
      }
      this.faceup_changed();
      // this.flip();
      // var y = 0;
      // setInterval(function() {
      //   y += 10;
      //   this.style.transform = "rotateY(" + y + "deg)";
      //   // this.flip();
      // }.bind(this), 300);
    }
  });
</script>
</dom-module>
